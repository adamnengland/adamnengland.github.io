---
layout: post
title: Migrating from Cake to Grunt
date: 2013-07-19 14:20:43.000000000 -05:00
categories: []
tags: []
status: draft
type: post
published: false
meta:
  _edit_last: '25054220'
  geo_public: '0'
---
<p>{% highlight coffeescript %}<br />
cp = require('child_process')</p>
<p>task "dev", -&gt;<br />
  console.log 'run dev server'<br />
  cp.spawn 'nodemon', ['./src/app.coffee'], customFds: [0..2]</p>
<p>task "test", "run tests", -&gt;<br />
  REPORTER = "nyan"<br />
  cp.exec "NODE_ENV=test<br />
    ./node_modules/.bin/mocha<br />
    --recursive<br />
    --compilers coffee:coffee-script<br />
    --reporter #{REPORTER}<br />
    --require coffee-script<br />
    --require test/test_helper.coffee<br />
    --colors<br />
  ", (err, output) -&gt;<br />
    throw err if err<br />
    console.log output</p>
<p>#mocha --recursive --compilers coffee:coffee-script --require coffee-script --require test/test_helper.coffee<br />
{% endhighlight %}</p>
<p>{% highlight coffeescript %}<br />
module.exports = (grunt) -&gt;<br />
  cp = require('child_process')<br />
  grunt.loadNpmTasks "grunt-contrib-watch"<br />
  grunt.loadNpmTasks "grunt-cafe-mocha"<br />
  grunt.loadNpmTasks 'grunt-contrib-coffee'</p>
<p>  grunt.initConfig<br />
    test:<br />
      all:<br />
        src: "test/**/*.coffee"<br />
        options:<br />
          ui: "tdd"<br />
          growl: true<br />
          reporter: "nyan"<br />
          require: ["should"]</p>
<p>    run:<br />
      cp.spawn 'nodemon', ['./src/app.coffee'], customFds: [0..2]</p>
<p>    dev:<br />
      tests:<br />
        files: ["!node_modules", "src/**/*.coffee", "test/**/*.coffee"]<br />
        tasks: ["run"]</p>
<p>  grunt.registerTask "default", ["jshint", "test"]<br />
  grunt.registerTask "test", "test"<br />
  grunt.registerTask "dev", "dev"<br />
{% endhighlight %}</p>
