---
layout: post
title: A Tale of 2 Authentications
date: 2012-04-16 09:33:24.000000000 -05:00
categories:
- API Critiques
- REST
tags:
- api
- API Critiques
- dropbox
- REST
- ruby
- sugarsync
status: publish
type: post
published: true
author: Adam N England
---
<p>I've recently had the opportunity to work with the REST APIs for two great services, <a href="http://www.dropbox.com">Dropbox</a> &amp; <a href="http://www.sugarsync.com">SugarSync</a>.</p>
<p>For the uninitiated, SugarSync and Dropbox are two competing cloud storage providers.  While Dropbox seems to have better name recognition, SugarSync provides a better pricing model, and great support across different Operating Systems &amp; Mobile Platforms.  However, I'm not here to talk about the merits of the <em><strong>products, </strong></em> I'm here to talk about the APIs, specifically the Authentication methods they use, and what other API developers can learn from them</p>
<p><strong>Authentication</strong></p>
<p><a href="https://www.dropbox.com/developers">Dropbox</a> -  The first obstacle with a service like Dropbox is authentication.  Dropbox uses <a href="http://en.wikipedia.org/wiki/Oauth">oAuth</a> v1.  While I usually find oAuth documentation confusing (and Dropbox is no exception), it is pretty easy to master with modern toolkits.  Within a few minutes, I was able to get my Dropbox request token (in ruby):</p>
<p><code><br />
dropboxSession = DropboxSession.new('myKey', 'mySecret')<br />
@dropBoxRequestToken = dropboxSession.get_request_token()</code></p>
<p>As is typical with oAuth, I can then send this request token to  dropbox, they request that the user authenticate it, and I receive my access token.</p>
<p><a href="https://www.sugarsync.com/developer">SugarSync</a> - This one is a little different.  SugarSync avoids the oAuth route, and instead provides a simple authentication method.  You make a call, providing the user's credentials, as well as your app key &amp; secret, SugarSync responds with an authorization token.  As opposed to oAuth, I just have to make a single POST call to https://api.sugarsync.com/authorization, and I'm done in 1 step.  Cool, huh?</p>
<p><strong>What's wrong with Sugar Sync's authentication model?</strong></p>
<p>I see this after time.</p>
<ol>
<li>Developer creates API</li>
<li>Developer wants to avoid storing user names and passwords, so developer looks at access-token based authentication.</li>
<li>Developer finds oAuth to be too cumbersome.</li>
<li>Developer creates one-off token based authentication.</li>
</ol>
<p>The error is the idea that non-oAuth, token based authentication is any more secure than simplyusing <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basic Authentication</a> (the simplest of all authentication schemes) over SSL.  The argument goes like this:</p>
<p><em>Token Authentication Defender:</em>  If we HTTP Basic Authentication, the API clients will either have to store the user name &amp; password, or ask the user for it each time they access the service.  We don't want the clients to store the password, to avoid potential exposure.</p>
<p><em>Me:</em>  How are you going to stop me from storing the password?  If I have to get the credentials from the user once, and send it to an "Authorize" call, what is going to stop me from saving it into my database?  Nothing.</p>
<p><strong>Some Simple Guidelines</strong></p>
<p>In this particular situation, I'd suggest that the SugarSync team move to an oAuth service.  It really is bad practice for their 3rd party apps to gain access to their users credentials.  oAuth, which slightly more complicated, provides the separation of concerns that this kind of API needs.  SugarSync should worry about username/password verification, and your app should simply sign the requests appropriately.</p>
<p>As for the APIs that I'll design in the future, I'll probably follow these (overly general) guidelines</p>
<ol>
<li>Is the API intended for a large number of 3rd party apps to access?  Is it essentially useless without the user providing credentials?  In these cases, oAuth seems like a winner.</li>
<li>Is this an API mostly for use between various products within the same company?  Do I feel comfortable with the client applications passing through a password?  In this case, HTTP Basic Auth is the easy way out, both for the API designer and consumer.  Just make sure you use SSL.</li>
<li>Do I have a really, really, really good reason to build a brand new authentication method?  Is my problem really unique compared to what Facebook, Twitter, or Dropbox does?  Am I prepared to open source some code and write about my solution to prevent it from becoming a one-off monster that the team will regret?  If so, maybe, just maybe, I'll write a new authentication method...</li>
</ol>
<p><strong>Update 7-31-2012</strong>  Since this was written, SugarSync has changed their API to remove the need to store a users password.  Definitely a step in the right direction. You can see the process <a href="https://www.sugarsync.com/dev/get-auth-token-example.html">here</a>.</p>
