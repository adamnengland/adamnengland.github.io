---
layout: post
title: Backbone.Validation with Chaplin and CoffeeScript
date: 2013-09-16 08:20:33.000000000 -05:00
categories:
- Web Development
tags:
- backbone.js
- chaplin.js
- coffeescript
- javascript
status: publish
type: post
published: true
meta:
  _edit_last: '25054220'
  _wpas_done_881585: '1'
  _publicize_pending: '1'
  _publicize_done_external: a:1:{s:8:"facebook";a:1:{i:1471181839;b:1;}}
  publicize_twitter_user: adamnengland
  _wpas_done_881586: '1'
  _wpas_done_881584: '1'
  twitter_cards_summary_img_size: a:6:{i:0;i:590;i:1;i:258;i:2;i:3;i:3;s:24:"width="590"
    height="258"";s:4:"bits";i:8;s:4:"mime";s:9:"image/png";}
  _oembed_6f6e824e3edbdfdb455843cb34ecb992: '{{unknown}}'
  _oembed_68fbb5e9a6b640970b133374f3300efc: '{{unknown}}'
author: Adam N England
---
<p>Any sizable web application needs validation.  Doing it yourself is for the birds, so I wanted to incorporate a backbone plugin to help solve the problem.  For this example I chose to use <a href="http://thedersen.com/projects/backbone-validation/">Backbone.Validation</a>.</p>
<p>Start with a basic framework. <a href="http://brunch.io/">Brunch Application Assembler</a> is a great way to bootstrap these projects.  I used Paul Miller's  <a href="https://github.com/paulmillr/brunch-with-chaplin">brunch-with-chaplin</a> skeleton.</p>
<p>brunch new gh:paulmillr/brunch-with-chaplin</p>
<p>To start up the server, type <em>brunch watch --server</em> and go to <em>http://localhost:3333/</em> in a new browser window. If everything is good, you'll see this:</p>
<p><a href="/assets/screen-shot-2013-09-06-at-3-25-22-pm.png"><img class="alignnone size-medium wp-image-287" alt="Screen Shot 2013-09-06 at 3.25.22 PM" src="/assets/screen-shot-2013-09-06-at-3-25-22-pm.png" width="300" height="131" /></a></p>
<p>You'll need a basic application to test out our concept, so we'll modify the routes and the controller, and add a new view and template to our project.</p>

{% highlight coffeescript linenos %}
module.exports = (match) ->
  match '', 'home#index'
  match 'form', 'home#form'
{% endhighlight %}

{% highlight coffeescript linenos %}
Controller = require 'controllers/base/controller'
HeaderView = require 'views/home/header-view'
FormView = require 'views/home/form'</p>
module.exports = class HomeController extends Controller
  form: ->
    @view = new FormView region: 'main'
{% endhighlight %}

{% highlight coffeescript linenos %}
View = require 'views/base/view'
Form = require 'models/form'
module.exports = class FormView extends View
  autoRender: true
  className: 'form-view'
  template: require './templates/form'
  events:
    'click a.validateButton' : "validate"
  initialize: ->
    super
    @model = new Form()
      validate: (e) ->
    @model.validate()
    e.preventDefault()
{% endhighlight %}

{% highlight html linenos %}
<form>
  <div>
    <label for="name">Name</label><nput type="text" name="name" class="name" />
  </div>
  <div>
    <label for="phone">Phone</label><input type="text" name="phone" class="phone" />
  </div>
  <div>
    <label for="email">Email</label><input type="text" name="email" class="email" />
  </div>
  <a href="#" class="validateButton">Validate</a>
</form>
{% endhighlight %}

<p>With that code in place, lets do a quick checkpoint <em>http://localhost:3333/form</em>.  We should get an ugly view like this:</p>
<p><a href="/assets/screen-shot-2013-09-06-at-3-50-32-pm.png"><img src="/assets/screen-shot-2013-09-06-at-3-50-32-pm.png" alt="Screen Shot 2013-09-06 at 3.50.32 PM" width="300" height="135" class="alignnone size-medium wp-image-295" /></a></p>
<p>So, we know we want a basic form that can save name, phone, and email.  Following the guidelines on the validation docs https://github.com/thedersen/backbone.validation, lets add the rules to our model.</p>

{% highlight coffeescript linenos %}
BaseModel = require 'models/base/model'
module.exports = class Form extends BaseModel
  validation :
    name:
      required: true
    email:
      required: true
      pattern: "email"
{% endhighlight %}

<p>We'll also need to add the <a href="https://raw.github.com/thedersen/backbone.validation/master/dist/backbone-validation.js">code</a> to our vendor/scripts folder.</p>
<p>In a perfect world, the @model.validate() call would execute our validation rules.  However, in this world, we get a javascript error</p>
<p><em>Uncaught TypeError: Object # has no method 'validate'</em></p>
<p>There is one final step.  We need to bind our model to the validation, so add the call in the attach method of our view:</p>

{% highlight coffeescript linenos %}
  attach: ->
    super
    Backbone.Validation.bind(@);
{% endhighlight %}
<p>Thats it!  <a href="https://github.com/adamnengland/backbone-validator-chaplin-example">Full source code</a> for the example is available on github.</p>
